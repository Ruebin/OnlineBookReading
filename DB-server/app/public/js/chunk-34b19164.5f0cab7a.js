(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34b19164"],{"0ff9":function(e,t,a){},4861:function(e,t,a){"use strict";var i=a("73a8"),l=a.n(i);l.a},"73a8":function(e,t,a){},"7f7f":function(e,t,a){var i=a("86cc").f,l=Function.prototype,n=/^\s*function ([^ (]*)/,o="name";o in l||a("9e1e")&&i(l,o,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(e){return""}}})},ae42:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Panel",{staticClass:"panel"},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,"label-width":200}},[a("FormItem",{attrs:{label:"电子书名称：",prop:"book_name"}},[a("Input",{attrs:{placeholder:"Enter something..."},model:{value:e.formValidate.book_name,callback:function(t){e.$set(e.formValidate,"book_name",t)},expression:"formValidate.book_name"}})],1),a("FormItem",{attrs:{label:"电子书作者：",prop:"author"}},[a("Input",{attrs:{placeholder:"Enter something..."},model:{value:e.formValidate.author,callback:function(t){e.$set(e.formValidate,"author",t)},expression:"formValidate.author"}})],1),a("FormItem",{attrs:{label:"出版社：",prop:"press"}},[a("Input",{attrs:{placeholder:"Enter something..."},model:{value:e.formValidate.press,callback:function(t){e.$set(e.formValidate,"press",t)},expression:"formValidate.press"}})],1),a("FormItem",{attrs:{label:"电子书类别：",prop:"type"}},[a("Input",{attrs:{placeholder:"Enter something..."},model:{value:e.formValidate.type,callback:function(t){e.$set(e.formValidate,"type",t)},expression:"formValidate.type"}})],1),a("FormItem",{attrs:{label:"封面图："}},[a("Row",{attrs:{type:"flex",justify:"center",align:"middle"}},[a("Col",{attrs:{span:"4"}},[a("form",{staticStyle:{display:"none"},attrs:{id:"uploadPicForm",enctype:"multipart/form-data"}},[a("input",{ref:"filePicField",attrs:{type:"file",name:"file",id:"uploadPicInput"}})]),a("Button",{staticClass:"uploadBtn",attrs:{type:"primary"},on:{click:function(t){return e.uploadPicTrigger()}}},[e._v("上传图片")])],1),a("Col",{attrs:{span:"20"}},[a("img",{attrs:{src:"",id:"uploadPicImg",alt:""}}),a("div",{staticClass:"uploadPic",attrs:{id:"uploadPic"}},[a("strong",{staticClass:"Pictext"},[e._v("推荐尺寸比例"),e._v("16:9")]),a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"170"}})],1)])],1)],1),a("FormItem",{attrs:{label:"电子书文件："}},[a("input",{ref:"filefileField",attrs:{type:"file",name:"file",id:"uploadfileInput"}})]),a("div",{staticClass:"summit"},[a("div",{staticClass:"sumitBtn"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("确认")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleReset("formValidate")}}},[e._v("重置")])],1)])],1)],1)},l=[],n=(a("7f7f"),a("eeb9"));function o(e){return Object(n["a"])({url:"/api/v1/book/public",method:"post",withCredentials:!0,data:e})}var r=a("f8f0"),s={data:function(){return{formValidate:{book_name:"test",author:"test",press:"test",type:"test",image:"",file:""}}},mounted:function(){""!==this.$store.state.bookinfo.book_name&&(this.formValidate=this.$store.state.book)},methods:{uploadPicTrigger:function(){this.$refs.filePicField.click(),this.change_pic("uploadPicImg","uploadPicInput")},change_pic:function(e,t){var a=document.getElementById(e),i=document.getElementById(t),l=this.$Message;function n(e){var t=e[0],i=new FileReader;if(!/image\/\w+/.test(t.type))return l.warning("请上传图片文件！"),!1;i.onload=function(e){a.src=e.target.result,document.getElementById("uploadPic").style.display="none"},i.readAsDataURL(t)}window.FileReader&&window.File&&window.FileList&&window.Blob||(a.alt="您的浏览器不支持fileReader"),i.addEventListener("change",function(e){var t=this.files;t.length?n(this.files):(a.src="timg.jpg",document.getElementById("uploadPic").style.display="block")})},handleSubmit:function(e){var t=this;0!==this.$refs.filePicField.files.length?this.formValidate.image=this.$refs.filePicField.files[0]:this.formValidate.image=null,0!==this.$refs.filefileField.files.length?this.formValidate.file=this.$refs.filefileField.files[0]:this.formValidate.file=null,this.$refs[e].validate(function(e){if(e){var a=new FormData;a.append("book_name",t.formValidate.book_name),a.append("author",t.formValidate.author),a.append("press",t.formValidate.press),a.append("type",t.formValidate.type),a.append("image",t.formValidate.image),a.append("file",t.formValidate.file),t.$Spin.show(),console.log(a.get("file")),o(a).then(function(e){200===e.status?(t.$Message.success("添加成功!"),t.$Spin.hide(),t.$router.push("/home")):t.$Message.error("添加错误!")})}else t.$Message.error("Fail!")})},handleReset:function(e){this.$refs[e].resetFields()}},components:{Panel:r["a"]}},f=s,c=(a("ffed"),a("2877")),d=Object(c["a"])(f,i,l,!1,null,"c1a8be14",null);t["default"]=d.exports},f8f0:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{class:[e.panelClass,e.cname]},[e._t("default")],2)},l=[],n={props:{cname:{type:String,default:""}},data:function(){return{panelClass:"panel"}}},o=n,r=(a("4861"),a("2877")),s=Object(r["a"])(o,i,l,!1,null,null,null);t["a"]=s.exports},ffed:function(e,t,a){"use strict";var i=a("0ff9"),l=a.n(i);l.a}}]);